{% extends 'base_template.html.twig' %}
{% block title %}
	{{constantes.application.website_name}}
	- Paiement
{% endblock %}

{% block body %}

	<form method="POST" novalidate action="index.php?controleur=paiement&methode=afficherResume">
		<input type="hidden" name="idAnnonce" value="{{ annonce.idAnnonce }}">
		<input type="hidden" name="ville" value="{{ ville }}">
		<input type="hidden" name="pays" value="{{ pays }}">
		<input type="hidden" name="adresse" value="{{ adresse }}">
		<input type="hidden" name="codePostal" value="{{ codePostal }}">
		<div class="row">
			<h2 class="form-title">Détails du paiement</h2>
			<p>Adresse de livraison→
				<b>paiement</b>
				→ récapituatif</p>

			<!-- Paiement -->
			<div class=" col mt-2 bg-light p-3 border border-2 rounded">

				<div class="mb-4">
					<label class="form-label required">Numéro de la carte</label>
					<input type="text" name="numCarte" maxlength="16" minlength="16" class="form-control shadow-sm {% if erreurs['numCarteMandatory'] or erreurs['numCarteNotInt'] or erreurs['numCarteIncorrectLength'] %} border-danger{% endif %}" placeholder="1234 1234 1234 1234" required>
					{% if erreurs['numCarteMandatory'] %}
						<p class="text-danger small">Le numéro de carte est obligatoire.</p>
					{% endif %}
					{% if erreurs['numCarteNotInt'] or erreurs['numCarteIncorrectLength']%}
						<p class="text-danger small">Le numéro de carte est invalide.</p>
					{% endif %}
				</div>
				<div class="row mb-4">
					<div class="col-md-6">
						<label class="form-label required">Date d'expiration</label>
						<input type="text" name="dateExpiration" maxlength="5" minlength="5" class="form-control shadow-sm {% if erreurs['dateExpirationMandatory'] or erreurs['dateExpirationIncorrectLength'] %} border-danger {% endif %}" placeholder="MM/YY" required>
						{% if erreurs['dateExpirationMandatory'] %}
							<p class="text-danger small">La date d'expiration est obligatoire.</p>
						{% endif %}
						{% if erreurs['dateExpirationIncorrectLength']%}
							<p class="text-danger small">La date d'expiration est invalide.</p>
						{% endif %}
					</div>
					<div class="col-md-6">
						<label class="form-label required">Code de Sécurité</label>
						<input type="text" name="codeSecurite" maxlength="3" minlength="3" class="form-control shadow-sm {% if erreurs['codeSecuriteMandatory'] or erreurs['codeSecuriteIncorrectLength'] %} border-danger {% endif %}}" placeholder="CVC" required>
						{% if erreurs['dateExpirationMandatory'] %}
							<p class="text-danger small">Le code de sécurité est obligatoire.</p>
						{% endif %}
						{% if erreurs['dateExpirationIncorrectLength']%}
							<p class="text-danger small">La code de sécurité est invalide.</p>
						{% endif %}
					</div>
				</div>

				<div class="mb-4">
					<label class="form-label required">Nom sur la carte</label>
					<input type="text" name="nomCarte" class="form-control shadow-sm {% if erreurs['nomCarteMandatory'] or erreurs['nomCarteNotString'] %} border-danger {% endif %}}" placeholder="Votre nom" required>
					{% if erreurs['nomCarteMandatory'] %}
						<p class="text-danger small">Le nom sur la carte est obligatoire.</p>
					{% endif %}
					{% if erreurs['nomCarteNotString']%}
						<p class="text-danger small">Le nom sur la carte est invalide.</p>
					{% endif %}
				</div>

				<div class="row">
					<div class="col-md-6">
						<a href="index.php?controleur=livraison&methode=achat&id={{ annonce.idAnnonce }}" class="btn btn-secondary w-100 mt-3 shadow-sm">Annuler</a>
					</div>
					<div class="col-md-6">
						<button type="submit" class="btn btn-primary w-100 mt-3 shadow-sm">
							Payer
						</button>
					</div>
				</div>
			</div>

			<!-- Récapitulatif -->
			<div class="col-md-6">
				<div class="bg-light mt-2 border border-2 rounded shadow-sm p-3">
					<h4 class="mb-3 fw-bold">Récapitulatif</h4>
					<hr>
					<div class="d-flex justify-content-between">
						<span>
							<strong>Titre de l'annonce</strong>
						</span>
						{{annonce.titre}}
					</div>
					<br>

					<div class="d-flex justify-content-between">
						<span>
							<strong>Jeu</strong>
						</span>
						{{ jeu.nom }}
					</div>
					<br>

					<div class="d-flex justify-content-between">
						<span>
							<strong>Prix de l'annonce</strong>
						</span>
						{{ annonce.prix }}
						€
					</div>
					<br>

					<div class="d-flex justify-content-between">
						<span>
							<strong>Ville</strong>
						</span>
						{{ville}}
					</div>
					<br>

					<div class="d-flex justify-content-between">
						<span>
							<strong>Code Postal</strong>
						</span>
						{{codePostal}}
					</div>
					<br>

					<div class="d-flex justify-content-between">
						<span>
							<strong>Adresse</strong>
						</span>
						{{adresse}}
					</div>
					<br>
					{% if complementAdresse %}
						<div class="d-flex justify-content-between">
							<span>
								<strong>Complément d'adresse</strong>
							</span>
							{{complementAdresse}}
						</div>
					{% endif %}
				</div>
			</div>
		</div>
	</form>
{% endblock %}
