{% extends "base_template.html.twig" %}

{% block title %}
	{{ constantes.application.website_name }}
	- Messagerie
{% endblock %}

{% block body %}
	<div class="container mt-5">
		<h1 class="text-center fw-bold">
			Votre Messagerie
		</h1>

		<div class="card shadow-sm border-0">
			<div class="list-group list-group-flush rounded shadow-sm">
				{% for message in messages %}
					<a
						href="index.php?controleur=messagerie&methode=afficher&id={{ message.idCompte }}&nom={{ message.nom }}&prenom={{ message.prenom }}" class="list-group-item d-flex align-items-center p-3">

						{# Avatar généré avec les initiales basées sur nom et prenom #}
						<div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px; font-weight: bold;">
							{{ message.prenom|first|upper }}{{ message.nom|first|upper }}
						</div>

						<div class="flex-grow-1">
							<div class="d-flex w-100 justify-content-between align-items-center">
								<h6 class="mb-1 fw-bold text-dark">
									{{ message.nom }}
									{{ message.prenom }}
								</h6>
							</div>
							<p class="mb-0 text-muted small text-truncate" style="max-width: 300px;">
								Cliquez pour voir l'historique de vos échanges...
							</p>
						</div>
					</a>
				{% else %}
					<div class="text-center p-5">
						<i class="bi bi-chat-square-dots text-muted" style="font-size: 3rem;"></i>
						<p class="mt-3 text-muted">Aucun message trouvé pour le moment.</p>
					</div>
				{% endfor %}
			</div>
		</div>

		<h1 class="text-center fw-bold mt-5">
			Vous pouvez aussi contacter
		</h1>

		<div class="card shadow-sm border-0">
			<div class="list-group list-group-flush rounded shadow-sm">
				{% for us in utilisateurs %}
					{% if us.idCompte != id %}
						<a
							href="index.php?controleur=messagerie&methode=afficher&id={{ us.idCompte }}&nom={{ us.nom }}&prenom={{ us.prenom }}" class="list-group-item d-flex align-items-center p-3">

							{# Avatar généré avec les initiales basées sur nom et prenom #}
							<div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px; font-weight: bold;">
								{{ us.prenom|first|upper }}{{ us.nom|first|upper }}
							</div>

							<div class="flex-grow-1">
								<div class="d-flex w-100 justify-content-between align-items-center">
									<h6 class="mb-1 fw-bold text-dark">
										{{ us.nom }}
										{{ us.prenom }}
									</h6>
								</div>
								<p class="mb-0 text-muted small text-truncate" style="max-width: 300px;">
									Cliquez pour echanger...
								</p>
							</div>
						</a>

					{% else %}
						<div class="text-center p-5">
							<i class="bi bi-chat-square-dots text-muted" style="font-size: 3rem;"></i>
							<p class="mt-3 text-muted">Aucun utilisateurs trouvé pour le moment.</p>
						</div>
					{% endif %}
				{% endfor %}
			</div>
		</div>
	</div>
{% endblock %}
